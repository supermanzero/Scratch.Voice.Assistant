<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‹¬ç«‹TTSè°ƒè¯•é¡µé¢</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        
        input[type="text"], textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
            box-sizing: border-box;
        }
        
        input[type="text"]:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #007bff;
        }
        
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .voice-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }
        
        .voice-option {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .voice-option:hover {
            border-color: #007bff;
            background-color: #f8f9fa;
        }
        
        .voice-option.selected {
            border-color: #007bff;
            background-color: #e3f2fd;
        }
        
        .voice-option input[type="radio"] {
            margin-right: 8px;
        }
        
        .voice-name {
            font-weight: 600;
            color: #333;
        }
        
        .voice-description {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 120px;
        }
        
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #0056b3;
        }
        
        .btn-primary:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #545b62;
        }
        
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-weight: 500;
        }
        
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .status.loading {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .audio-controls {
            margin-top: 20px;
            text-align: center;
        }
        
        audio {
            width: 100%;
            margin-top: 10px;
        }
        
        .debug-info {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        
        .debug-info h3 {
            margin-top: 0;
            color: #333;
        }
        
        .debug-info pre {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
        
        .character-count {
            text-align: right;
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        
        .character-count.warning {
            color: #ff6b35;
        }
        
        .character-count.error {
            color: #dc3545;
        }
        
        .api-config {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .api-config h3 {
            margin-top: 0;
            color: #495057;
        }
        
        .api-config input {
            margin-bottom: 10px;
        }
        
        .tts-engine-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .engine-option {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .engine-option:hover {
            border-color: #007bff;
            background-color: #f8f9fa;
        }
        
        .engine-option.selected {
            border-color: #007bff;
            background-color: #e3f2fd;
        }
        
        .engine-option input[type="radio"] {
            margin-right: 5px;
        }
        
        .voice-category {
            margin-bottom: 25px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .category-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin: 0;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 600;
            border-bottom: 1px solid #e9ecef;
        }
        
        .voice-category .voice-options {
            padding: 15px;
            background-color: #fafbfc;
        }
        
        .voice-category .voice-option {
            background-color: white;
            border: 1px solid #e9ecef;
            margin-bottom: 10px;
        }
        
        .voice-category .voice-option:last-child {
            margin-bottom: 0;
        }
        
        .voice-category .voice-option:hover {
            border-color: #007bff;
            background-color: #f8f9fa;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 123, 255, 0.1);
        }
        
        .voice-category .voice-option.selected {
            border-color: #007bff;
            background-color: #e3f2fd;
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤ ç‹¬ç«‹TTSè°ƒè¯•é¡µé¢</h1>
        
        <div class="api-config">
            <h3>ğŸ”‘ APIé…ç½®</h3>
            <div class="form-group">
                <label for="baiduAK">ç™¾åº¦API Key (AK):</label>
                <input type="text" id="baiduAK" placeholder="è¯·è¾“å…¥ç™¾åº¦API Key" value="FeNVdlSqSTt9IO3Bz4SCDiVj">
            </div>
            <div class="form-group">
                <label for="baiduSK">ç™¾åº¦Secret Key (SK):</label>
                <input type="text" id="baiduSK" placeholder="è¯·è¾“å…¥ç™¾åº¦Secret Key" value="NL9bpxsOt7pxf1m3v43G5vPD5CIjoSFo">
            </div>
        </div>
        
        <div class="form-group">
            <label>TTSå¼•æ“é€‰æ‹©ï¼š</label>
            <div class="tts-engine-selector">
                <div class="engine-option" data-engine="baidu">
                    <input type="radio" name="engine" value="baidu" id="engine-baidu" checked>
                    <label for="engine-baidu">ç™¾åº¦TTS</label>
                </div>
                <div class="engine-option" data-engine="browser">
                    <input type="radio" name="engine" value="browser" id="engine-browser">
                    <label for="engine-browser">æµè§ˆå™¨TTS</label>
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <label for="textInput">è¦åˆæˆçš„æ–‡æœ¬ï¼š</label>
            <textarea id="textInput" placeholder="è¯·è¾“å…¥è¦åˆæˆçš„æ–‡æœ¬ï¼Œä¸è¶…è¿‡60ä¸ªå­—ç¬¦..." maxlength="60"></textarea>
            <div id="charCount" class="character-count">0/60 å­—ç¬¦</div>
        </div>
        
        <div class="form-group" id="baiduVoiceSection">
            <label>é€‰æ‹©è¯­éŸ³è§’è‰²ï¼š</label>
            
            <!-- åŸºç¡€éŸ³åº“ -->
            <div class="voice-category">
                <h4 class="category-title">ğŸµ åŸºç¡€éŸ³åº“</h4>
                <div class="voice-options">
                    <div class="voice-option" data-voice="baidu-0">
                        <input type="radio" name="voice" value="baidu-0" id="voice-0">
                        <label for="voice-0">
                            <div class="voice-name">åº¦å°ç¾ (æ ‡å‡†å¥³ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-1">
                        <input type="radio" name="voice" value="baidu-1" id="voice-1">
                        <label for="voice-1">
                            <div class="voice-name">åº¦å°å®‡ (äº²åˆ‡ç”·å£°)</div>
                            <div class="voice-description">å¯¹è¯åŠ©æ‰‹ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4140">
                        <input type="radio" name="voice" value="baidu-4140" id="voice-3">
                        <label for="voice-3">
                            <div class="voice-name">åº¦é€é¥ (æƒ…æ„Ÿç”·å£°)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4">
                        <input type="radio" name="voice" value="baidu-4" id="voice-4">
                        <label for="voice-4">
                            <div class="voice-name">åº¦ä¸«ä¸« (ç«¥å£°)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- ç²¾å“éŸ³åº“ -->
            <div class="voice-category">
                <h4 class="category-title">â­ ç²¾å“éŸ³åº“</h4>
                <div class="voice-options">
                    <div class="voice-option" data-voice="baidu-5003">
                        <input type="radio" name="voice" value="baidu-5003" id="voice-5003">
                        <label for="voice-5003">
                            <div class="voice-name">åº¦é€é¥ (æƒ…æ„Ÿç”·å£°)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-5118">
                        <input type="radio" name="voice" value="baidu-5118" id="voice-5118">
                        <label for="voice-5118">
                            <div class="voice-name">åº¦å°é¹¿ (ç”œç¾å¥³å£°)</div>
                            <div class="voice-description">å¯¹è¯åŠ©æ‰‹ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-106">
                        <input type="radio" name="voice" value="baidu-106" id="voice-106">
                        <label for="voice-106">
                            <div class="voice-name">åº¦åšæ–‡ (ä¸“ä¸šç”·ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-103">
                        <input type="radio" name="voice" value="baidu-103" id="voice-103">
                        <label for="voice-103">
                            <div class="voice-name">åº¦ç±³æœµ (å¯çˆ±ç«¥å£°)</div>
                            <div class="voice-description">å¯¹è¯åŠ©æ‰‹ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-110" checked>
                        <input type="radio" name="voice" value="baidu-110" id="voice-110">
                        <label for="voice-110">
                            <div class="voice-name">åº¦å°ç«¥ (ç«¥å£°ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-111">
                        <input type="radio" name="voice" value="baidu-111" id="voice-111">
                        <label for="voice-111">
                            <div class="voice-name">åº¦å°èŒ (è½¯èŒå¦¹å­)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-5">
                        <input type="radio" name="voice" value="baidu-5" id="voice-5">
                        <label for="voice-5">
                            <div class="voice-name">åº¦å°å¨‡ (æˆç†Ÿå¥³ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- è‡»å“éŸ³åº“ -->
            <div class="voice-category">
                <h4 class="category-title">ğŸ’ è‡»å“éŸ³åº“</h4>
                <div class="voice-options">
                    <div class="voice-option" data-voice="baidu-4003">
                        <input type="radio" name="voice" value="baidu-4003" id="voice-4003">
                        <label for="voice-4003">
                            <div class="voice-name">åº¦é€é¥ (æƒ…æ„Ÿç”·å£°)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4106">
                        <input type="radio" name="voice" value="baidu-4106" id="voice-4106">
                        <label for="voice-4106">
                            <div class="voice-name">åº¦åšæ–‡ (ä¸“ä¸šç”·ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4115">
                        <input type="radio" name="voice" value="baidu-4115" id="voice-4115">
                        <label for="voice-4115">
                            <div class="voice-name">åº¦å°è´¤ (ç”µå°ç”·ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-5147">
                        <input type="radio" name="voice" value="baidu-5147" id="voice-5147">
                        <label for="voice-5147">
                            <div class="voice-name">åº¦å¸¸ç›ˆ (ç”µå°å¥³ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-5976">
                        <input type="radio" name="voice" value="baidu-5976" id="voice-5976">
                        <label for="voice-5976">
                            <div class="voice-name">åº¦å°çš® (èŒå¨ƒç«¥å£°)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-5971">
                        <input type="radio" name="voice" value="baidu-5971" id="voice-5971">
                        <label for="voice-5971">
                            <div class="voice-name">åº¦çš®ç‰¹ (è€å¤–ç”·å£°)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4164">
                        <input type="radio" name="voice" value="baidu-4164" id="voice-4164">
                        <label for="voice-4164">
                            <div class="voice-name">åº¦é˜¿è‚¯ (ä¸»æ’­ç”·å£°)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4176">
                        <input type="radio" name="voice" value="baidu-4176" id="voice-4176">
                        <label for="voice-4176">
                            <div class="voice-name">åº¦æœ‰ä¸º (ç£æ€§ç”·å£°)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4259">
                        <input type="radio" name="voice" value="baidu-4259" id="voice-4259">
                        <label for="voice-4259">
                            <div class="voice-name">åº¦å°æ–° (æ’­éŸ³å¥³å£°)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4119">
                        <input type="radio" name="voice" value="baidu-4119" id="voice-4119">
                        <label for="voice-4119">
                            <div class="voice-name">åº¦å°é¹¿ (ç”œç¾å¥³å£°)</div>
                            <div class="voice-description">å¯¹è¯åŠ©æ‰‹ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4105">
                        <input type="radio" name="voice" value="baidu-4105" id="voice-4105">
                        <label for="voice-4105">
                            <div class="voice-name">åº¦çµå„¿ (æ¸…æ¿€å¥³å£°)</div>
                            <div class="voice-description">å¯¹è¯åŠ©æ‰‹ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4117">
                        <input type="radio" name="voice" value="baidu-4117" id="voice-4117">
                        <label for="voice-4117">
                            <div class="voice-name">åº¦å°ä¹” (æ´»æ³¼å¥³å£°)</div>
                            <div class="voice-description">å¯¹è¯åŠ©æ‰‹ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4288">
                        <input type="radio" name="voice" value="baidu-4288" id="voice-4288">
                        <label for="voice-4288">
                            <div class="voice-name">åº¦æ™´å²š (ç”œç¾å¥³å£°)</div>
                            <div class="voice-description">å¯¹è¯åŠ©æ‰‹ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4192">
                        <input type="radio" name="voice" value="baidu-4192" id="voice-4192">
                        <label for="voice-4192">
                            <div class="voice-name">åº¦é’å· (æ¸©æŸ”ç”·å£°)</div>
                            <div class="voice-description">å¯¹è¯åŠ©æ‰‹ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4100">
                        <input type="radio" name="voice" value="baidu-4100" id="voice-4100">
                        <label for="voice-4100">
                            <div class="voice-name">åº¦å°é›¯ (æ´»åŠ›å¥³ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4103">
                        <input type="radio" name="voice" value="baidu-4103" id="voice-4103">
                        <label for="voice-4103">
                            <div class="voice-name">åº¦ç±³æœµ (å¯çˆ±å¥³å£°)</div>
                            <div class="voice-description">å¯¹è¯åŠ©æ‰‹ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4144">
                        <input type="radio" name="voice" value="baidu-4144" id="voice-4144">
                        <label for="voice-4144">
                            <div class="voice-name">åº¦å§—å§— (å¨±ä¹å¥³å£°)</div>
                            <div class="voice-description">é…éŸ³ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4278">
                        <input type="radio" name="voice" value="baidu-4278" id="voice-4278">
                        <label for="voice-4278">
                            <div class="voice-name">åº¦å°è´ (çŸ¥è¯†å¥³ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4143">
                        <input type="radio" name="voice" value="baidu-4143" id="voice-4143">
                        <label for="voice-4143">
                            <div class="voice-name">åº¦æ¸…é£ (é…éŸ³ç”·å£°)</div>
                            <div class="voice-description">é…éŸ³ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4140">
                        <input type="radio" name="voice" value="baidu-4140" id="voice-4140">
                        <label for="voice-4140">
                            <div class="voice-name">åº¦å°æ–° (ä¸“ä¸šå¥³ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4129">
                        <input type="radio" name="voice" value="baidu-4129" id="voice-4129">
                        <label for="voice-4129">
                            <div class="voice-name">åº¦å°å½¦ (çŸ¥è¯†ç”·ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4149">
                        <input type="radio" name="voice" value="baidu-4149" id="voice-4149">
                        <label for="voice-4149">
                            <div class="voice-name">åº¦æ˜Ÿæ²³ (å¹¿å‘Šç”·å£°)</div>
                            <div class="voice-description">é…éŸ³ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4254">
                        <input type="radio" name="voice" value="baidu-4254" id="voice-4254">
                        <label for="voice-4254">
                            <div class="voice-name">åº¦å°æ¸… (å¹¿å‘Šå¥³å£°)</div>
                            <div class="voice-description">é…éŸ³ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4206">
                        <input type="radio" name="voice" value="baidu-4206" id="voice-4206">
                        <label for="voice-4206">
                            <div class="voice-name">åº¦åšæ–‡ (ç»¼è‰ºç”·å£°)</div>
                            <div class="voice-description">é…éŸ³ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4147">
                        <input type="radio" name="voice" value="baidu-4147" id="voice-4147">
                        <label for="voice-4147">
                            <div class="voice-name">åº¦äº‘æœµ (å¯çˆ±ç«¥å£°)</div>
                            <div class="voice-description">é…éŸ³ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4141">
                        <input type="radio" name="voice" value="baidu-4141" id="voice-4141">
                        <label for="voice-4141">
                            <div class="voice-name">åº¦å©‰å©‰ (ç”œç¾å¥³å£°)</div>
                            <div class="voice-description">é…éŸ³ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4226">
                        <input type="radio" name="voice" value="baidu-4226" id="voice-4226">
                        <label for="voice-4226">
                            <div class="voice-name">å—æ–¹ (ç”µå°å¥³ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-6205">
                        <input type="radio" name="voice" value="baidu-6205" id="voice-6205">
                        <label for="voice-6205">
                            <div class="voice-name">åº¦æ‚ ç„¶ (æ—ç™½ç”·å£°)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-6221">
                        <input type="radio" name="voice" value="baidu-6221" id="voice-6221">
                        <label for="voice-6221">
                            <div class="voice-name">åº¦äº‘è± (æ—ç™½å¥³å£°)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-6546">
                        <input type="radio" name="voice" value="baidu-6546" id="voice-6546">
                        <label for="voice-6546">
                            <div class="voice-name">åº¦æ¸…è±ª (é€é¥ä¾ å®¢)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-6602">
                        <input type="radio" name="voice" value="baidu-6602" id="voice-6602">
                        <label for="voice-6602">
                            <div class="voice-name">åº¦æ¸…æŸ” (æ¸©æŸ”ç”·ç¥)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-6562">
                        <input type="radio" name="voice" value="baidu-6562" id="voice-6562">
                        <label for="voice-6562">
                            <div class="voice-name">åº¦é›¨æ¥  (å…ƒæ°”å°‘å¥³)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-6543">
                        <input type="radio" name="voice" value="baidu-6543" id="voice-6543">
                        <label for="voice-6543">
                            <div class="voice-name">åº¦é›¨èŒ (é‚»å®¶å¥³å­©)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-6747">
                        <input type="radio" name="voice" value="baidu-6747" id="voice-6747">
                        <label for="voice-6747">
                            <div class="voice-name">åº¦ä¹¦å¤ (æƒ…æ„Ÿç”·å£°)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-6748">
                        <input type="radio" name="voice" value="baidu-6748" id="voice-6748">
                        <label for="voice-6748">
                            <div class="voice-name">åº¦ä¹¦ä¸¥ (æ²‰ç¨³ç”·å£°)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-6746">
                        <input type="radio" name="voice" value="baidu-6746" id="voice-6746">
                        <label for="voice-6746">
                            <div class="voice-name">åº¦ä¹¦é“ (æ²‰ç¨³ç”·å£°)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-6644">
                        <input type="radio" name="voice" value="baidu-6644" id="voice-6644">
                        <label for="voice-6644">
                            <div class="voice-name">åº¦ä¹¦å® (äº²å’Œå¥³å£°)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4148">
                        <input type="radio" name="voice" value="baidu-4148" id="voice-4148">
                        <label for="voice-4148">
                            <div class="voice-name">åº¦å°å¤ (ç”œç¾å¥³å£°)</div>
                            <div class="voice-description">å°è¯´ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4277">
                        <input type="radio" name="voice" value="baidu-4277" id="voice-4277">
                        <label for="voice-4277">
                            <div class="voice-name">è¥¿è´ (è„±å£ç§€å¥³å£°)</div>
                            <div class="voice-description">é…éŸ³ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-4114">
                        <input type="radio" name="voice" value="baidu-4114" id="voice-4114">
                        <label for="voice-4114">
                            <div class="voice-name">é˜¿é¾™ (è¯´ä¹¦ç”·å£°)</div>
                            <div class="voice-description">é…éŸ³ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-5153">
                        <input type="radio" name="voice" value="baidu-5153" id="voice-5153">
                        <label for="voice-5153">
                            <div class="voice-name">åº¦å¸¸æ‚¦ (æ°‘ç”Ÿå¥³ä¸»æ’­)</div>
                            <div class="voice-description">èµ„è®¯ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                    
                    <div class="voice-option" data-voice="baidu-6561">
                        <input type="radio" name="voice" value="baidu-6561" id="voice-6561">
                        <label for="voice-6561">
                            <div class="voice-name">åº¦å°ä¹ (å¯çˆ±ç«¥å£°)</div>
                            <div class="voice-description">å¯¹è¯åŠ©æ‰‹ | ä¸­æ–‡/è‹±æ–‡</div>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="form-group" id="browserVoiceSection" style="display: none;">
            <label for="browserVoiceSelect">é€‰æ‹©è¯­éŸ³ï¼š</label>
            <select id="browserVoiceSelect">
                <option value="">åŠ è½½ä¸­...</option>
            </select>
        </div>
        
        <div class="controls">
            <button id="testBtn" class="btn-primary">ğŸµ æµ‹è¯•è¯­éŸ³åˆæˆ</button>
            <button id="clearBtn" class="btn-secondary">ğŸ—‘ï¸ æ¸…ç©ºæ–‡æœ¬</button>
            <button id="testTokenBtn" class="btn-success">ğŸ”‘ æµ‹è¯•API Token</button>
        </div>
        
        <div id="status" class="status" style="display: none;"></div>
        
        <div class="audio-controls" id="audioControls" style="display: none;">
            <h3>ç”Ÿæˆçš„éŸ³é¢‘ï¼š</h3>
            <audio id="audioPlayer" controls></audio>
        </div>
        
        <div class="debug-info" id="debugInfo" style="display: none;">
            <h3>è°ƒè¯•ä¿¡æ¯ï¼š</h3>
            <pre id="debugContent"></pre>
        </div>
    </div>

    <script>
        class StandaloneTTSDebugger {
            constructor() {
                this.textInput = document.getElementById('textInput');
                this.charCount = document.getElementById('charCount');
                this.testBtn = document.getElementById('testBtn');
                this.clearBtn = document.getElementById('clearBtn');
                this.testTokenBtn = document.getElementById('testTokenBtn');
                this.status = document.getElementById('status');
                this.audioControls = document.getElementById('audioControls');
                this.audioPlayer = document.getElementById('audioPlayer');
                this.debugInfo = document.getElementById('debugInfo');
                this.debugContent = document.getElementById('debugContent');
                this.baiduAK = document.getElementById('baiduAK');
                this.baiduSK = document.getElementById('baiduSK');
                this.browserVoiceSelect = document.getElementById('browserVoiceSelect');
                this.baiduVoiceSection = document.getElementById('baiduVoiceSection');
                this.browserVoiceSection = document.getElementById('browserVoiceSection');
                
                this.init();
            }
            
            init() {
                // è®¾ç½®é»˜è®¤æ–‡æœ¬
                this.textInput.value = 'å­¦ä¼šç”¨ Scratch çš„é”®ç›˜æ£€æµ‹ã€è§’è‰²ç§»åŠ¨å’Œè¯´è¯ç§¯æœ¨ï¼Œåˆ¶ä½œä¸€ä¸ªå¯ä»¥é”®ç›˜æ§åˆ¶çŒ«å’ªç§»åŠ¨å¹¶è¯´è¯çš„äº’åŠ¨ç¨‹åºï¼';
                this.updateCharCount();
                
                // ç»‘å®šäº‹ä»¶
                this.textInput.addEventListener('input', () => this.updateCharCount());
                this.testBtn.addEventListener('click', () => this.testTTS());
                this.clearBtn.addEventListener('click', () => this.clearText());
                this.testTokenBtn.addEventListener('click', () => this.testBaiduToken());
                
                // è¯­éŸ³é€‰æ‹©äº‹ä»¶
                document.querySelectorAll('.voice-option').forEach(option => {
                    option.addEventListener('click', () => this.selectVoice(option));
                });
                
                // å¼•æ“é€‰æ‹©äº‹ä»¶
                document.querySelectorAll('.engine-option').forEach(option => {
                    option.addEventListener('click', () => this.selectEngine(option));
                });
                
                // é»˜è®¤é€‰æ‹©åº¦å°ç«¥ï¼ˆç²¾å“éŸ³åº“ï¼‰
                document.querySelector('[data-voice="baidu-110"]').classList.add('selected');
                document.querySelector('[data-engine="baidu"]').classList.add('selected');
                
                // åŠ è½½æµè§ˆå™¨è¯­éŸ³
                this.loadBrowserVoices();
            }
            
            updateCharCount() {
                const count = this.textInput.value.length;
                const maxCount = 60;
                this.charCount.textContent = `${count}/${maxCount} å­—ç¬¦`;
                
                if (count > maxCount) {
                    this.charCount.className = 'character-count error';
                } else if (count > maxCount * 0.8) {
                    this.charCount.className = 'character-count warning';
                } else {
                    this.charCount.className = 'character-count';
                }
            }
            
            selectVoice(option) {
                // ç§»é™¤æ‰€æœ‰é€‰ä¸­çŠ¶æ€
                document.querySelectorAll('.voice-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // æ·»åŠ é€‰ä¸­çŠ¶æ€
                option.classList.add('selected');
                
                // é€‰ä¸­å¯¹åº”çš„radioæŒ‰é’®
                const radio = option.querySelector('input[type="radio"]');
                radio.checked = true;
            }
            
            selectEngine(option) {
                // ç§»é™¤æ‰€æœ‰é€‰ä¸­çŠ¶æ€
                document.querySelectorAll('.engine-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // æ·»åŠ é€‰ä¸­çŠ¶æ€
                option.classList.add('selected');
                
                // é€‰ä¸­å¯¹åº”çš„radioæŒ‰é’®
                const radio = option.querySelector('input[type="radio"]');
                radio.checked = true;
                
                // æ˜¾ç¤º/éšè—ç›¸åº”çš„è¯­éŸ³é€‰æ‹©åŒºåŸŸ
                const engine = radio.value;
                if (engine === 'baidu') {
                    this.baiduVoiceSection.style.display = 'block';
                    this.browserVoiceSection.style.display = 'none';
                } else {
                    this.baiduVoiceSection.style.display = 'none';
                    this.browserVoiceSection.style.display = 'block';
                }
            }
            
            async loadBrowserVoices() {
                try {
                    // ç­‰å¾…è¯­éŸ³åˆ—è¡¨åŠ è½½
                    await new Promise(resolve => {
                        if (speechSynthesis.getVoices().length > 0) {
                            resolve();
                        } else {
                            speechSynthesis.addEventListener('voiceschanged', resolve, { once: true });
                        }
                    });
                    
                    const voices = speechSynthesis.getVoices();
                    const chineseVoices = voices.filter(voice => 
                        voice.lang.startsWith('zh') || 
                        voice.name.includes('Chinese') || 
                        voice.name.includes('ä¸­æ–‡')
                    );
                    
                    this.browserVoiceSelect.innerHTML = '';
                    
                    if (chineseVoices.length > 0) {
                        chineseVoices.forEach(voice => {
                            const option = document.createElement('option');
                            option.value = voice.name;
                            option.textContent = `${voice.name} (${voice.lang})`;
                            this.browserVoiceSelect.appendChild(option);
                        });
                    } else {
                        // å¦‚æœæ²¡æœ‰ä¸­æ–‡è¯­éŸ³ï¼Œæ˜¾ç¤ºæ‰€æœ‰è¯­éŸ³
                        voices.forEach(voice => {
                            const option = document.createElement('option');
                            option.value = voice.name;
                            option.textContent = `${voice.name} (${voice.lang})`;
                            this.browserVoiceSelect.appendChild(option);
                        });
                    }
                    
                    console.log('åŠ è½½äº†', voices.length, 'ä¸ªæµè§ˆå™¨è¯­éŸ³ï¼Œå…¶ä¸­', chineseVoices.length, 'ä¸ªä¸­æ–‡è¯­éŸ³');
                } catch (error) {
                    console.error('åŠ è½½æµè§ˆå™¨è¯­éŸ³å¤±è´¥:', error);
                    this.browserVoiceSelect.innerHTML = '<option value="">åŠ è½½å¤±è´¥</option>';
                }
            }
            
            clearText() {
                this.textInput.value = '';
                this.updateCharCount();
                this.hideStatus();
                this.hideAudioControls();
                this.hideDebugInfo();
            }
            
            showStatus(message, type = 'info') {
                this.status.textContent = message;
                this.status.className = `status ${type}`;
                this.status.style.display = 'block';
            }
            
            hideStatus() {
                this.status.style.display = 'none';
            }
            
            showAudioControls(audioData) {
                this.audioPlayer.src = audioData;
                this.audioControls.style.display = 'block';
            }
            
            hideAudioControls() {
                this.audioControls.style.display = 'none';
            }
            
            showDebugInfo(info) {
                this.debugContent.textContent = JSON.stringify(info, null, 2);
                this.debugInfo.style.display = 'block';
            }
            
            hideDebugInfo() {
                this.debugInfo.style.display = 'none';
            }
            
            async testBaiduToken() {
                const ak = this.baiduAK.value.trim();
                const sk = this.baiduSK.value.trim();
                
                if (!ak || !sk) {
                    this.showStatus('è¯·è¾“å…¥ç™¾åº¦API Keyå’ŒSecret Keyï¼', 'error');
                    return;
                }
                
                this.testTokenBtn.disabled = true;
                this.testTokenBtn.textContent = 'ğŸ”„ æµ‹è¯•ä¸­...';
                this.showStatus('æ­£åœ¨æµ‹è¯•ç™¾åº¦API Token...', 'loading');
                
                try {
                    const token = await this.getBaiduAccessToken(ak, sk);
                    this.showStatus(`âœ… API Tokenæµ‹è¯•æˆåŠŸï¼Token: ${token.substring(0, 20)}...`, 'success');
                    
                    this.showDebugInfo({
                        success: true,
                        token: token.substring(0, 20) + '...',
                        fullTokenLength: token.length,
                        timestamp: new Date().toISOString()
                    });
                } catch (error) {
                    console.error('Tokenæµ‹è¯•å¤±è´¥:', error);
                    this.showStatus(`âŒ API Tokenæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                    
                    this.showDebugInfo({
                        error: {
                            message: error.message,
                            stack: error.stack
                        },
                        ak: ak.substring(0, 10) + '...',
                        sk: sk.substring(0, 10) + '...',
                        timestamp: new Date().toISOString()
                    });
                } finally {
                    this.testTokenBtn.disabled = false;
                    this.testTokenBtn.textContent = 'ğŸ”‘ æµ‹è¯•API Token';
                }
            }
            
            async getBaiduAccessToken(ak, sk) {
                // ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ç»•è¿‡CORSé™åˆ¶
                const proxyUrl = '/proxy/baidu-token';
                console.log('é€šè¿‡ä»£ç†è·å–ç™¾åº¦API tokenï¼ŒURL:', proxyUrl);
                
                const formData = new URLSearchParams();
                formData.append('ak', ak);
                formData.append('sk', sk);
                
                const response = await fetch(proxyUrl, { 
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: formData
                });
                console.log('ç™¾åº¦API tokenå“åº”çŠ¶æ€:', response.status, response.statusText);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('ç™¾åº¦API tokenè¯·æ±‚å¤±è´¥ï¼Œå“åº”å†…å®¹:', errorText);
                    throw new Error(`è·å–ç™¾åº¦API tokenå¤±è´¥: ${response.status} - ${errorText}`);
                }
                
                const data = await response.json();
                console.log('ç™¾åº¦API tokenå“åº”æ•°æ®é”®:', Object.keys(data));
                
                if (data.error) {
                    throw new Error(`ç™¾åº¦APIè®¤è¯å¤±è´¥: ${data.error_description || data.error}`);
                }
                
                if (!data.access_token) {
                    throw new Error('ç™¾åº¦APIå“åº”ä¸­æ²¡æœ‰access_token');
                }
                
                return data.access_token;
            }
            
            async testTTS() {
                const text = this.textInput.value.trim();
                if (!text) {
                    this.showStatus('è¯·è¾“å…¥è¦åˆæˆçš„æ–‡æœ¬ï¼', 'error');
                    return;
                }
                
                const selectedEngine = document.querySelector('input[name="engine"]:checked');
                if (!selectedEngine) {
                    this.showStatus('è¯·é€‰æ‹©TTSå¼•æ“ï¼', 'error');
                    return;
                }
                
                const engine = selectedEngine.value;
                
                if (engine === 'baidu') {
                    if (text.length > 60) {
                        this.showStatus('ç™¾åº¦TTSæ–‡æœ¬é•¿åº¦ä¸èƒ½è¶…è¿‡60ä¸ªå­—ç¬¦ï¼', 'error');
                        return;
                    }
                    
                    const selectedVoice = document.querySelector('input[name="voice"]:checked');
                    if (!selectedVoice) {
                        this.showStatus('è¯·é€‰æ‹©è¯­éŸ³è§’è‰²ï¼', 'error');
                        return;
                    }
                    
                    await this.testBaiduTTS(text, selectedVoice.value);
                } else if (engine === 'browser') {
                    await this.testBrowserTTS(text);
                }
            }
            
            async testBaiduTTS(text, voice) {
                const ak = this.baiduAK.value.trim();
                const sk = this.baiduSK.value.trim();
                
                if (!ak || !sk) {
                    this.showStatus('è¯·è¾“å…¥ç™¾åº¦API Keyå’ŒSecret Keyï¼', 'error');
                    return;
                }
                
                this.testBtn.disabled = true;
                this.testBtn.textContent = 'ğŸ”„ åˆæˆä¸­...';
                this.showStatus('æ­£åœ¨è°ƒç”¨ç™¾åº¦TTS API...', 'loading');
                this.hideAudioControls();
                this.hideDebugInfo();
                
                try {
                    const startTime = Date.now();
                    
                    // è·å–access token
                    const accessToken = await this.getBaiduAccessToken(ak, sk);
                    
                    // ä»è¯­éŸ³é€‰æ‹©ä¸­æå–è¯­éŸ³ID
                    const voiceId = voice.replace('baidu-', '');
                    
                    // ç›´æ¥ä¼ è¾“å­—ç¬¦ä¸²æ–‡æœ¬ï¼Œä¸è¿›è¡Œç¼–ç 
                    console.log(`åŸå§‹æ–‡æœ¬: "${text}"`);
                    console.log(`ç›´æ¥ä¼ è¾“æ–‡æœ¬: "${text}"`);
                    
                    // æ ¹æ®å®˜æ–¹APIæ–‡æ¡£æ„å»ºè¯·æ±‚æ•°æ®
                    const requestData = {
                        tex: text,   // ç›´æ¥ä¼ è¾“å­—ç¬¦ä¸²æ–‡æœ¬
                        tok: accessToken,   // è®¿é—®ä»¤ç‰Œ
                        cuid: 'Lb4nwynEiEtTYmg6L7VlgxYPKUDS76Mg', // ç”¨æˆ·å”¯ä¸€æ ‡è¯†
                        ctp: '1',          // å®¢æˆ·ç«¯ç±»å‹ï¼Œwebç«¯å¡«å†™å›ºå®šå€¼1
                        lan: 'zh',         // è¯­è¨€é€‰æ‹©ï¼Œå›ºå®šå€¼zh
                        spd: '5',          // è¯­é€Ÿï¼Œå–å€¼0-15ï¼Œé»˜è®¤ä¸º5
                        pit: '5',          // éŸ³è°ƒï¼Œå–å€¼0-15ï¼Œé»˜è®¤ä¸º5
                        vol: '5',          // éŸ³é‡ï¼Œå–å€¼0-15ï¼Œé»˜è®¤ä¸º5
                        per: voiceId,      // è¯­éŸ³äººé€‰æ‹©
                        aue: '3'           // éŸ³é¢‘æ ¼å¼ï¼š3ä¸ºmp3æ ¼å¼(é»˜è®¤)
                    };
                    
                    console.log('ç™¾åº¦TTSè¯·æ±‚æ•°æ®:', requestData);
                    
                    // æ„å»ºform data
                    const formData = new URLSearchParams();
                    Object.keys(requestData).forEach(key => {
                        formData.append(key, requestData[key]);
                    });
                    
                    // é€šè¿‡ä»£ç†å‘é€è¯·æ±‚
                    const response = await fetch('/proxy/baidu-tts', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                            'Accept': '*/*'
                        },
                        body: formData
                    });
                    
                    const endTime = Date.now();
                    const duration = endTime - startTime;
                    
                    console.log('ç™¾åº¦TTSå“åº”çŠ¶æ€:', response.status, response.statusText);
                    
                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`ç™¾åº¦TTSè¯·æ±‚å¤±è´¥: ${response.status} - ${errorText}`);
                    }
                    
                    // æ£€æŸ¥å“åº”å†…å®¹ç±»å‹
                    const contentType = response.headers.get('content-type');
                    console.log('å“åº”å†…å®¹ç±»å‹:', contentType);
                    
                    if (contentType && contentType.includes('application/json')) {
                        // å¦‚æœè¿”å›çš„æ˜¯JSONï¼Œè¯´æ˜æœ‰é”™è¯¯
                        const errorData = await response.json();
                        throw new Error(`ç™¾åº¦TTSé”™è¯¯: ${errorData.error_msg || JSON.stringify(errorData)}`);
                    }
                    
                    // è·å–éŸ³é¢‘æ•°æ®
                    const audioBlob = await response.blob();
                    console.log('éŸ³é¢‘æ•°æ®å¤§å°:', audioBlob.size, 'bytes');
                    
                    if (audioBlob.size === 0) {
                        throw new Error('ç™¾åº¦TTSè¿”å›çš„éŸ³é¢‘æ•°æ®ä¸ºç©º');
                    }
                    
                    // åˆ›å»ºéŸ³é¢‘URL
                    const audioUrl = URL.createObjectURL(audioBlob);
                    
                    // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
                    this.showStatus(`âœ… ç™¾åº¦TTSè¯­éŸ³åˆæˆæˆåŠŸï¼è€—æ—¶: ${duration}ms`, 'success');
                    
                    // æ˜¾ç¤ºéŸ³é¢‘æ§ä»¶
                    this.showAudioControls(audioUrl);
                    
                    // æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
                    this.showDebugInfo({
                        request: {
                            text: text,
                            voice: voice,
                            voiceId: voiceId,
                            textLength: text.length,
                            encodingMethod: 'direct_transmission'
                        },
                        response: {
                            success: true,
                            audioDataSize: audioBlob.size,
                            contentType: contentType,
                            duration: `${duration}ms`
                        },
                        timestamp: new Date().toISOString()
                    });
                    
                } catch (error) {
                    console.error('ç™¾åº¦TTSæµ‹è¯•å¤±è´¥:', error);
                    this.showStatus(`âŒ ç™¾åº¦TTSè¯­éŸ³åˆæˆå¤±è´¥: ${error.message}`, 'error');
                    
                    // æ˜¾ç¤ºé”™è¯¯è°ƒè¯•ä¿¡æ¯
                    this.showDebugInfo({
                        error: {
                            message: error.message,
                            stack: error.stack
                        },
                        request: {
                            text: text,
                            voice: voice,
                            textLength: text.length
                        },
                        timestamp: new Date().toISOString()
                    });
                } finally {
                    this.testBtn.disabled = false;
                    this.testBtn.textContent = 'ğŸµ æµ‹è¯•è¯­éŸ³åˆæˆ';
                }
            }
            
            async testBrowserTTS(text) {
                this.testBtn.disabled = true;
                this.testBtn.textContent = 'ğŸ”„ åˆæˆä¸­...';
                this.showStatus('æ­£åœ¨ä½¿ç”¨æµè§ˆå™¨TTS...', 'loading');
                this.hideAudioControls();
                this.hideDebugInfo();
                
                try {
                    const startTime = Date.now();
                    
                    // åœæ­¢å½“å‰æ’­æ”¾
                    speechSynthesis.cancel();
                    
                    // åˆ›å»ºè¯­éŸ³åˆæˆå¯¹è±¡
                    const utterance = new SpeechSynthesisUtterance(text);
                    
                    // è®¾ç½®è¯­éŸ³
                    const selectedVoiceName = this.browserVoiceSelect.value;
                    if (selectedVoiceName) {
                        const voices = speechSynthesis.getVoices();
                        const selectedVoice = voices.find(voice => voice.name === selectedVoiceName);
                        if (selectedVoice) {
                            utterance.voice = selectedVoice;
                        }
                    }
                    
                    // è®¾ç½®è¯­éŸ³å‚æ•°
                    utterance.rate = 1.0;    // è¯­é€Ÿ
                    utterance.pitch = 1.0;   // éŸ³è°ƒ
                    utterance.volume = 0.8;  // éŸ³é‡
                    utterance.lang = 'zh-CN'; // è¯­è¨€
                    
                    // ç­‰å¾…è¯­éŸ³æ’­æ”¾å®Œæˆ
                    await new Promise((resolve, reject) => {
                        utterance.onend = () => {
                            const endTime = Date.now();
                            const duration = endTime - startTime;
                            
                            this.showStatus(`âœ… æµè§ˆå™¨TTSæ’­æ”¾å®Œæˆï¼è€—æ—¶: ${duration}ms`, 'success');
                            
                            this.showDebugInfo({
                                request: {
                                    text: text,
                                    voice: selectedVoiceName,
                                    textLength: text.length
                                },
                                response: {
                                    success: true,
                                    duration: `${duration}ms`,
                                    voiceUsed: utterance.voice?.name || 'é»˜è®¤è¯­éŸ³'
                                },
                                timestamp: new Date().toISOString()
                            });
                            
                            resolve();
                        };
                        
                        utterance.onerror = (error) => {
                            reject(new Error(`æµè§ˆå™¨TTSé”™è¯¯: ${error.error}`));
                        };
                        
                        // å¼€å§‹æ’­æ”¾
                        speechSynthesis.speak(utterance);
                    });
                    
                } catch (error) {
                    console.error('æµè§ˆå™¨TTSæµ‹è¯•å¤±è´¥:', error);
                    this.showStatus(`âŒ æµè§ˆå™¨TTSå¤±è´¥: ${error.message}`, 'error');
                    
                    this.showDebugInfo({
                        error: {
                            message: error.message,
                            stack: error.stack
                        },
                        request: {
                            text: text,
                            textLength: text.length
                        },
                        timestamp: new Date().toISOString()
                    });
                } finally {
                    this.testBtn.disabled = false;
                    this.testBtn.textContent = 'ğŸµ æµ‹è¯•è¯­éŸ³åˆæˆ';
                }
            }
        }
        
        // åˆå§‹åŒ–è°ƒè¯•å™¨
        document.addEventListener('DOMContentLoaded', () => {
            new StandaloneTTSDebugger();
        });
    </script>
</body>
</html>
